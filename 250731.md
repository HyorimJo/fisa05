# 7/31 Docker 4일차 / Linux 1일차

## Keywords
Container 설계, 경량화
Linux 기초

***

## Keeps
alpine은 경량화!

## Problem
docker 포기하지 말기

## Try
- Dockerfile 설계도 
- docker-compose 아파트.
- 집(container 하나하나)/문(port)/공용공간(volume)/길(network) 등
- image-포장지에 싼 아파트


## 알아둘 내용

# 1. Docker

## 1. 도커 컨테이너 생성시 고려할 점

**1) 1 컨테이너 당 1 프로세스**:

- 각 컨테이너는 하나의 프로세스만 실행하도록 설계하여, 문제 발생 시 격리 및 디버깅이 용이하게 만듭니다.
- 단일 책임 원칙을 준수함으로써 유지 보수 및 스케일링을 단순화합니다.

**2) 변경 불가능한 인프라( `Immutable Infrastructure` )원칙 준수**:

- **관리 - 버전 태그 사용**: 각 이미지 빌드 시 고유한 버전 태그를 사용하여 이미지 변경을 명확히 합니다
    - 업데이트나 변경 사항은 새로운 이미지를 빌드하고 배포함으로써 관리합니다.
- **검증** - 새 이미지가 프로덕션 환경에 배포되기 전에 테스트 환경에서 충분히 검증합니다.
- **빌드와 배포**
    - 컨테이너 실행 중에는 컨테이너 내부에서 변경 작업을 하지 않으며, 변경이 필요할 경우 새로운 이미지를 빌드합니다.
    - Jenkins/Github Action 등을 활용한 CI/CD 파이프라인 등을 구축하고 배포 이력을 관리하는 방법을 통해 컨테이너 이미지를 중간에서 변경 불가능하게 만들어 일관된 배포 환경을 보장합니다.

**3) 경량 도커 이미지로 생성**:

- 불필요한 패키지와 라이브러리를 제거하여 이미지 크기를 최소화하고 보안 및 성능을 향상시킵니다.
- 경량 이미지는 배포 시간과 리소스 사용을 줄이는 데 도움이 됩니다.

**4) 실행 계정은 root 이외의 사용자로 지정**:

- 보안 상의 이유로 컨테이너 내부의 프로세스는 root 권한이 아닌 일반 사용자 권한으로 실행합니다.
- 이는 잠재적인 보안 취약점을 줄이고, 시스템 전체에 대한 영향을 최소화합니다.

## 2.  Dockerfile 작성 모범 사례

- 컨테이너 이미지를 효율적이고 안전하게 유지하며, 빌드 및 실행 과정에서 발생할 수 있는 문제를 최소화하기 위한 Dockerfile 작성 원칙
    
    1) **경량 베이스 이미지 선택**
    
    - `alpine`과 같은 경량 베이스 이미지를 사용하여 불필요한 파일과 라이브러리를 최소화합니다.
    
    **2) Multi-Stage Builds 활용**
    
    - **이미지 크기 최적화**: Multi-Stage Build를 사용하여 빌드와 실행 환경을 분리하고, 최종 이미지를 최소화합니다.
    
    **3) 필요한 파일만 복사**
    
    - `.dockerignore` 파일을 사용하여 빌드 컨텍스트에서 불필요한 파일을 제외합니다.
    
    **4) 명확한 레이어 캐싱 전략**
    
    - 자주 변경되지 않는 항목을 먼저 실행하여 캐시를 최대한 활용합니다.
    
    **5)  최소한의 권한 사용**
    
    - 컨테이너 내부의 프로세스를 비루트 사용자로 실행해 보안을 강화합니다.
    
    **6) 불필요한 레이어 줄이기**
    
    - 여러 명령어를 하나로 결합하여 불필요한 레이어 생성을 줄입니다.

# 2. Linux

## 1. 리눅스란?
- 1991년에는 핀란드에서 대학생 리누스 토르발스가 기업 전유물이던 유닉스를 개인 사용자도 사용할 수 있게 만들어 세상에 공개했는데, 이것이 바로 리눅스(Linux)입니다.
- 리눅스는 **오픈 소스(open source) 방식**으로 개발되어 전 세계 수많은 사람의 노력으로 지금까지 발전을 거듭하고 있습니다.
- 유닉스를 기반으로 만든 리눅스는 이미 **서버 운영체제** 시장에서 유닉스를 넘어 확고한 지위를 다지고 있으며, **안드로이드도 리눅스 커널을 기초로 개발**되었습니다.
- 컴퓨터라는 하드웨어에서 다양한 애플리케이션을 돌리기 위한 기본 소프트웨어로 리눅스는 일반적인 **데스크톱 뿐 아니라 임베디드, 서버 등 다양한 분야에서 널리 사용**되고 있습니다.

## 2. 커널이란?
운영체제의 핵심으로, 모든 작업에 우선하여 동작하는 프로그램을 의미합니다.
- 인터럽트 처리, 프로세스 관리, 메모리 관리, 파일 시스템 관리, 프로그래밍 인터페이스 제공 등 운영체제의 기본적인 기능들을 제공합니다.
- 엄밀하게 따지면 리눅스는 커널 부분만을 의미합니다.
